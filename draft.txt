ssf2 draft

ssfの原始定義を踏まえるが、ssf version 1 の詳細レベルとの互換性にはこだわらない。

「解釈の方法を付加した、csvの複合体」として考える。

基本データは、matrix
行数と列数をあらかじめ指示できる。
データ上の行数列数と、展開先の行数列数が異なってもよい。
たとえば、データを、改行のみを区切りとした1次元で記述できる。
多すぎるデータは無視。
少ない場合、Rのように、先頭から再利用する。
これにより、
行単位で同じデータ（数式）が繰り返されるようなものを単純に記述できる。

解釈の方法を人が見て、
データをきりだして利用することもできるわけだ。

主な解釈方法は、
格納先の名前（変数名、ワークシート名、）
格納先の行数、列数
データの区切り形式
データの行数、列数
カラム名
カラム型
コメント

ファイル全体の、
エンコード形式と改行コードを先頭付近に明記できる。

差分をサポートするために、
格納先のアドレス（行列番号など）を指定できる。

エクセルから作成する場合、
どこがmatrixの単位なのか、といったことを示す指示書が別途必要になる。
それがなければ、シート単位に、usedrangeを一つの表とした巨大matrixが対象。

R, エクセル, アクセス, HTML, TeX の間でのデータ交換を念頭に置く。

開始タグ、終了タグ

エスケープブロック

nop

データ行を示す先頭文字は、正規表現の ^ とする。
すなわち、特に先頭文字を設けず、有効範囲内のすべての行が対象。


RのreadLinesが、
改行コードを指定する方式でなく、
Cr, Lf, CrLF のいずれも行区切りとする、
という方式なので、
それに合わせるのがいい気がする。


Rの、 list(d1=data.frame, d2=data.frame,,,)
Excel の、 Book, Sheets
HTML の、 tabbed tables
Access (mdb object) の、 mdb, tables
MySQL の、 tables
Word の、 見出し付き複数の表、ないしは、見出しと本文と段落
Google doc spreadsheet の、 表

を、簡単に対応させることを、目標とする。

open office とか、office 365 を若干意識する。
GUIまで作りこまないで、
実行すれば動く、単純なコマンド（関数）を用意する。


ssf バージョンを記載する。
前のが無印で、
今回のは、
'ssf2'
バージョンは、テキスト文字。

だから、
'ssf2/hoge' みたいなマイナー拡張バージョンがありうるということ。

x-* みたいな、ユーザー定義情報を許して、
ローカルな取り決めによる情報付加を許す。
ようは、
x-ではじまる名称を、こちらのシステムは、将来的にも使わない、という約束。


前回、vba拡張した仕組みを、
今回は、
R script 向けに活用することを考える。

つまり、
single file で、
R のデータとスクリプトを包含し、
しかも、その読み込み、実行順が明確になっているということ。

まあ、R script 自身も、データ保持ができたはずだから、
それほど目新しいものではないが、
データを主とした記述という視点になる。

R は
Web access できるのだから、
R 版を利用して、
巡回ツールのR版を作ってみたらいい。
Google search tool の、より一般化したやつってことだな。


当面、パッケージは考えず、
git によるスクリプト形式の提供でやる。
その方が、改変が楽で早い。
それに、他のアプリ向けツールも同封しやすい。
バグが取れて仕様が落ち着くまでは、その方針。

